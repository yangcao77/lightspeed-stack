apiVersion: v1
kind: Pod
metadata:
  name: llama-stack-service
  namespace: e2e-rhoai-dsc
spec:
  imagePullSecrets:
    - name: quay-lightspeed-pull-secret
  containers:
    - name: llama-stack-container
      env:
        - name: KSVC_URL
          valueFrom:
            secretKeyRef:
              name: api-url-secret
              key: key
        - name: VLLM_API_KEY
          valueFrom:
            secretKeyRef:
              name: vllm-api-key-secret
              key: key
      image: ${LLAMA_STACK_IMAGE}
      ports:
        - containerPort: 8321
      volumeMounts:
        - name: app-root
          mountPath: /opt/app-root/src/.llama
        - name: config
          mountPath: /opt/app-root/run.yaml
          subPath: run.yaml
  volumes:
    - name: app-root
      emptyDir: {}
    - name: config
      configMap:
        name: llama-stack-config
